# =============================================================
# K-CHOPORE Configuration File
# Pipeline for ONT Direct RNA Sequencing Analysis
# =============================================================
# Experiment: anac017 mutant vs WT, Control vs Antimycin A (AA)
# 2x2 factorial design, 3 biological replicates per group
# Organism: Arabidopsis thaliana (TAIR10 + AtRTDv2)
# Sequencing: ONT MinION, R9.4.1 flowcell, Direct RNA
# =============================================================

# -------------------------------------------------------------
# SAMPLE SHEET
# Each sample has: genotype, treatment, and list of FAST5 dirs
# Multiple fast5_dirs = re-run data to merge (concatenated FASTQs)
# Sample IDs use underscores only (FLAIR requirement)
# -------------------------------------------------------------
samples:
  # --- Wild Type, Control ---
  WT_C_R1:
    genotype: "WT"
    treatment: "C"
    fast5_dirs: ["WT_C_R1"]
  WT_C_R2:
    genotype: "WT"
    treatment: "C"
    fast5_dirs: ["WT_C_R2"]
  WT_C_R3:
    genotype: "WT"
    treatment: "C"
    fast5_dirs: ["WT_C_R3"]

  # --- Wild Type, Antimycin A ---
  WT_AA_R1:
    genotype: "WT"
    treatment: "AA"
    fast5_dirs: ["WT_AA_R1"]
  WT_AA_R2:
    genotype: "WT"
    treatment: "AA"
    fast5_dirs: ["WT_AA_R2"]
  WT_AA_R3:
    genotype: "WT"
    treatment: "AA"
    fast5_dirs: ["WT_AA_R3", "WT_AA_R3_2"]

  # --- anac017-1 mutant, Control ---
  anac017_1_C_R1:
    genotype: "anac017_1"
    treatment: "C"
    fast5_dirs: ["anac017-1_C_R1"]
  anac017_1_C_R2:
    genotype: "anac017_1"
    treatment: "C"
    fast5_dirs: ["anac017-1_C_R2"]
  anac017_1_C_R3:
    genotype: "anac017_1"
    treatment: "C"
    fast5_dirs: ["anac017-1_C_R3"]

  # --- anac017-1 mutant, Antimycin A ---
  anac017_1_AA_R1:
    genotype: "anac017_1"
    treatment: "AA"
    fast5_dirs: ["anac017-1_AA_R1"]
  anac017_1_AA_R2:
    genotype: "anac017_1"
    treatment: "AA"
    fast5_dirs: ["anac017-1_AA_R2", "anac017_AA_R2-2"]
  anac017_1_AA_R3:
    genotype: "anac017_1"
    treatment: "AA"
    fast5_dirs: ["anac017-1_AA_R3"]

# -------------------------------------------------------------
# INPUT FILES AND DIRECTORIES
# -------------------------------------------------------------
input_files:
  # NAS mount point (FAST5 data, read-only, mounted via SSHFS)
  nas_mount: "/nas"

  # Reference genome and annotations
  reference_genome: "data/reference/genome/TAIR10_chr_all.fas.fasta"
  reference_genome_mmi: "data/reference/genome/TAIR10_chr_all.fas.fasta.mmi"
  gtf_file: "data/reference/annotations/AtRTDv2_QUASI_19April2016.gtf"
  transcriptome_fasta: "data/reference/transcriptome/transcriptome.fa"

# -------------------------------------------------------------
# OUTPUT SETTINGS
# -------------------------------------------------------------
output:
  path: "results"
  logs: "logs"

# -------------------------------------------------------------
# TOOL CONFIGURATIONS
# -------------------------------------------------------------
tools:
  # Basecalling - Guppy CPU (R9.4.1 flowcell, direct RNA)
  basecaller: "guppy"
  guppy_config_file: "/opt/ont-guppy-cpu/data/rna_r9.4.1_70bps_hac.cfg"

  # Alignment - minimap2 (splice-aware for direct RNA)
  minimap2_preset: "splice"
  minimap2_kmer_size: 14
  minimap2_extra_flags: "--secondary=no --MD"

  # Read filtering - NanoFilt
  nanofilt_min_quality: 7
  nanofilt_min_length: 200
  nanofilt_max_length: 0

  # Quality control
  nanoplot_format: "png"
  pycoqc_min_pass_qual: 7

  # Isoform analysis - FLAIR
  flair_support: 3
  flair_stringent: true

  # RNA modification detection - ELIGOS2
  eligos2_pval: 0.05
  eligos2_oddR: 5
  eligos2_esb: 0.2

  # RNA modification detection - m6Anet
  m6anet_num_iterations: 1000
  m6anet_num_processors: 4

  # Differential expression - DESeq2 (2x2 factorial)
  deseq2_padj_threshold: 0.05
  deseq2_lfc_threshold: 1.0

# -------------------------------------------------------------
# ANALYSIS PARAMETERS
# -------------------------------------------------------------
params:
  threads: 40
  latency_wait: 60
